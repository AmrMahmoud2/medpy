<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>medpy.metric.histogram &mdash; MedPy 0.4.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" >
    <link rel="search" title="Search" href="../../../search.html" >
    <link rel="top" title="MedPy 0.4.0 documentation" href="../../../index.html" >
    <link rel="up" title="Module code" href="../../index.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://github.com/loli/medpy/">GitHub</a></li>
        <li class="active"><a href="https://pypi.python.org/pypi/MedPy/">PyPi</a></li>
	
        <li class="active"><a href="../../../index.html">MedPy 0.4.0 documentation</a></li>
	
          <li class="active"><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../../../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <h1>Source code for medpy.metric.histogram</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (C) 2013 Oskar Maier</span>
<span class="c1"># </span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1"># </span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1"># </span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1"># author Oskar Maier</span>
<span class="c1"># version r0.1.0</span>
<span class="c1"># since 2011-12-01</span>
<span class="c1"># status Release</span>

<span class="c1"># build-in modules</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># third-party modules</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="c1"># own modules</span>

<span class="c1"># code</span>
<span class="c1"># ////////////////////////////// #</span>
<span class="c1"># Bin-by-bin comparison measures #</span>
<span class="c1"># ////////////////////////////// #</span>

<div class="viewcode-block" id="minowski"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.minowski.html#medpy.metric.histogram.minowski">[docs]</a><span class="k">def</span> <span class="nf">minowski</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span> <span class="c1"># 46..45..14,11..43..44 / 45 us for p=int(-inf..-24..-1,1..24..inf) / float @array, +20 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minowski distance.</span>
<span class="sd">    </span>
<span class="sd">    With :math:`p=2` equal to the Euclidean distance, with :math:`p=1` equal to the Manhattan distance,</span>
<span class="sd">    and the Chebyshev distance implementation represents the case of :math:`p=\pm inf`.</span>
<span class="sd">    </span>
<span class="sd">    The Minowksi distance between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is</span>
<span class="sd">    defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_p(H, H&#39;) = \left(\sum_{m=1}^M|H_m - H&#39;_m|^p  </span>
<span class="sd">            \right)^{\frac{1}{p}}</span>

<span class="sd">    *Attributes:*</span>
<span class="sd">    </span>
<span class="sd">    - a real metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - :math:`d(H, H&#39;)\in[0, \sqrt[p]{2}]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram.</span>
<span class="sd">    p : float</span>
<span class="sd">        The :math:`p` value in the Minowksi distance formula.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    minowski : float</span>
<span class="sd">        Minowski distance.</span>
<span class="sd">    </span>
<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If ``p`` is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;p can not be zero&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">int</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span> <span class="k">return</span> <span class="n">__minowski_low_positive_integer_p</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">25</span><span class="p">:</span> <span class="k">return</span> <span class="n">__minowski_low_negative_integer_p</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">),</span> <span class="n">p</span><span class="p">)),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">p</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">__minowski_low_positive_integer_p</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span> <span class="c1"># 11..43 us for p = 1..24 \w 100 bins</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A faster implementation of the Minowski distance for positive integer &lt; 25.</span>
<span class="sd">    @note do not use this function directly, but the general @link minowski() method.</span>
<span class="sd">    @note the passed histograms must be scipy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mult</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">dif</span> <span class="o">=</span> <span class="n">mult</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="n">dif</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dif</span><span class="p">,</span> <span class="n">mult</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dif</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">p</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__minowski_low_negative_integer_p</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span> <span class="c1"># 14..46 us for p = -1..-24 \w 100 bins</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A faster implementation of the Minowski distance for negative integer &gt; -25.</span>
<span class="sd">    @note do not use this function directly, but the general @link minowski() method.</span>
<span class="sd">    @note the passed histograms must be scipy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mult</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">dif</span> <span class="o">=</span> <span class="n">mult</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="n">dif</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dif</span><span class="p">,</span> <span class="n">mult</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">dif</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">p</span><span class="p">)</span>

<div class="viewcode-block" id="manhattan"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.manhattan.html#medpy.metric.histogram.manhattan">[docs]</a><span class="k">def</span> <span class="nf">manhattan</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># # 7 us @array, 31 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equal to Minowski distance with :math:`p=1`.</span>
<span class="sd">    </span>
<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    minowski</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="euclidean"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.euclidean.html#medpy.metric.histogram.euclidean">[docs]</a><span class="k">def</span> <span class="nf">euclidean</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 9 us @array, 33 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equal to Minowski distance with :math:`p=2`.</span>
<span class="sd">    </span>
<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    minowski</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">))))</span></div>

<div class="viewcode-block" id="chebyshev"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.chebyshev.html#medpy.metric.histogram.chebyshev">[docs]</a><span class="k">def</span> <span class="nf">chebyshev</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 12 us @array, 36 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chebyshev distance.</span>
<span class="sd">    </span>
<span class="sd">    Also Tchebychev distance, Maximum or :math:`L_{\infty}` metric; equal to Minowski</span>
<span class="sd">    distance with :math:`p=+\infty`. For the case of :math:`p=-\infty`, use `chebyshev_neg`.</span>
<span class="sd">    </span>
<span class="sd">    The Chebyshev distance between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is</span>
<span class="sd">    defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\infty}(H, H&#39;) = \max_{m=1}^M|H_m-H&#39;_m|</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>
<span class="sd">    </span>
<span class="sd">    - semimetric (triangle equation satisfied?)</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>
<span class="sd">    </span>
<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chebyshev : float</span>
<span class="sd">        Chebyshev distance.</span>
<span class="sd">    </span>
<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    minowski, chebyshev_neg</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="chebyshev_neg"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.chebyshev_neg.html#medpy.metric.histogram.chebyshev_neg">[docs]</a><span class="k">def</span> <span class="nf">chebyshev_neg</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 12 us @array, 36 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chebyshev negative distance.</span>
<span class="sd">    </span>
<span class="sd">    Also Tchebychev distance, Minimum or :math:`L_{-\infty}` metric; equal to Minowski</span>
<span class="sd">    distance with :math:`p=-\infty`. For the case of :math:`p=+\infty`, use `chebyshev`.</span>
<span class="sd">    </span>
<span class="sd">    The Chebyshev distance between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is</span>
<span class="sd">    defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{-\infty}(H, H&#39;) = \min_{m=1}^M|H_m-H&#39;_m|</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric (triangle equation satisfied?)</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chebyshev_neg : float</span>
<span class="sd">        Chebyshev negative distance.</span>
<span class="sd">    </span>
<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    minowski, chebyshev</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="histogram_intersection"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.histogram_intersection.html#medpy.metric.histogram.histogram_intersection">[docs]</a><span class="k">def</span> <span class="nf">histogram_intersection</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 6 us @array, 30 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the common part of two histograms.</span>
<span class="sd">    </span>
<span class="sd">    The histogram intersection between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is</span>
<span class="sd">    defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\cap}(H, H&#39;) = \sum_{m=1}^M\min(H_m, H&#39;_m)</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - a real metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    histogram_intersection : float</span>
<span class="sd">        Intersection between the two histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="histogram_intersection_1"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.histogram_intersection_1.html#medpy.metric.histogram.histogram_intersection_1">[docs]</a><span class="k">def</span> <span class="nf">histogram_intersection_1</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 7 us @array, 31 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns the histogram intersection similarity into a distance measure for normalized,</span>
<span class="sd">    positive histograms.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\bar{\cos}}(H, H&#39;) = 1 - d_{\cap}(H, H&#39;)</span>
<span class="sd">    </span>
<span class="sd">    See `histogram_intersection` for the definition of :math:`d_{\cap}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    histogram_intersection : float</span>
<span class="sd">        Intersection between the two histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">histogram_intersection</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span></div>

<div class="viewcode-block" id="relative_deviation"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.relative_deviation.html#medpy.metric.histogram.relative_deviation">[docs]</a><span class="k">def</span> <span class="nf">relative_deviation</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 18 us @array, 42 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the deviation between two histograms.</span>
<span class="sd">    </span>
<span class="sd">    The relative deviation between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is</span>
<span class="sd">    defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{rd}(H, H&#39;) =</span>
<span class="sd">            \frac{</span>
<span class="sd">                \sqrt{\sum_{m=1}^M(H_m - H&#39;_m)^2}</span>
<span class="sd">              }{</span>
<span class="sd">                \frac{1}{2}</span>
<span class="sd">                \left(</span>
<span class="sd">                    \sqrt{\sum_{m=1}^M H_m^2} +</span>
<span class="sd">                    \sqrt{\sum_{m=1}^M {H&#39;}_m^2}</span>
<span class="sd">                \right)</span>
<span class="sd">              }</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric (triangle equation satisfied?)</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \sqrt{2}]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 2]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable    </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    relative_deviation : float</span>
<span class="sd">        Relative deviation between the two histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">)))</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span><span class="p">)))</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h2</span><span class="p">))))</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span></div>

<div class="viewcode-block" id="relative_bin_deviation"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.relative_bin_deviation.html#medpy.metric.histogram.relative_bin_deviation">[docs]</a><span class="k">def</span> <span class="nf">relative_bin_deviation</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 79 us @array, 104 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the bin-wise deviation between two histograms.</span>
<span class="sd">    </span>
<span class="sd">    The relative bin deviation between two histograms :math:`H` and :math:`H&#39;` of size</span>
<span class="sd">    :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{rbd}(H, H&#39;) = \sum_{m=1}^M</span>
<span class="sd">            \frac{</span>
<span class="sd">                \sqrt{(H_m - H&#39;_m)^2}</span>
<span class="sd">              }{</span>
<span class="sd">                \frac{1}{2}</span>
<span class="sd">                \left(</span>
<span class="sd">                    \sqrt{H_m^2} +</span>
<span class="sd">                    \sqrt{{H&#39;}_m^2}</span>
<span class="sd">                \right)</span>
<span class="sd">              }</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - a real metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    relative_bin_deviation : float</span>
<span class="sd">        Relative bin deviation between the two histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">))</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span><span class="p">))</span> <span class="o">+</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h2</span><span class="p">)))</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="n">old_err_state</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># divide through zero only occurs when the bin is zero in both histograms, in which case the division is 0/0 and leads to (and should lead to) 0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_err_state</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="n">scipy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># faster than scipy.nan_to_num, which checks for +inf and -inf also</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="chi_square"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.chi_square.html#medpy.metric.histogram.chi_square">[docs]</a><span class="k">def</span> <span class="nf">chi_square</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 23 us @array, 49 us @list \w 100</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chi-square distance.</span>
<span class="sd">    </span>
<span class="sd">    Measure how unlikely it is that one distribution (histogram) was drawn from the</span>
<span class="sd">    other. The Chi-square distance between two histograms :math:`H` and :math:`H&#39;` of size</span>
<span class="sd">    :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\chi^2}(H, H&#39;) = \sum_{m=1}^M</span>
<span class="sd">            \frac{</span>
<span class="sd">                (H_m - H&#39;_m)^2</span>
<span class="sd">            }{</span>
<span class="sd">                H_m + H&#39;_m</span>
<span class="sd">            }</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 2]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable     </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chi_square : float</span>
<span class="sd">        Chi-square distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">old_err_state</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># divide through zero only occurs when the bin is zero in both histograms, in which case the division is 0/0 and leads to (and should lead to) 0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_err_state</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="n">scipy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># faster than scipy.nan_to_num, which checks for +inf and -inf also</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="kullback_leibler"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.kullback_leibler.html#medpy.metric.histogram.kullback_leibler">[docs]</a><span class="k">def</span> <span class="nf">kullback_leibler</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 83 us @array, 109 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kullback-Leibler divergence.</span>
<span class="sd">    </span>
<span class="sd">    Compute how inefficient it would to be code one histogram into another.</span>
<span class="sd">    Actually computes :math:`\frac{d_{KL}(h1, h2) + d_{KL}(h2, h1)}{2}` to achieve symmetry.</span>
<span class="sd">    </span>
<span class="sd">    The Kullback-Leibler divergence between two histograms :math:`H` and :math:`H&#39;` of size</span>
<span class="sd">    :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{KL}(H, H&#39;) = \sum_{m=1}^M H_m\log\frac{H_m}{H&#39;_m}</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - quasimetric (but made symetric)</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, where h1[i] &gt; 0 for any i such that h2[i] &gt; 0, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, where h2[i] &gt; 0 for any i such that h1[i] &gt; 0, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kullback_leibler : float</span>
<span class="sd">        Kullback-Leibler divergence.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_err_state</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">__kullback_leibler</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span> <span class="o">+</span> <span class="n">__kullback_leibler</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">h1</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_err_state</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="ne">FloatingPointError</span><span class="p">:</span>
        <span class="n">scipy</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_err_state</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;h1 can only contain zero values where h2 also contains zero values and vice-versa&#39;</span><span class="p">)</span></div>
    
<span class="k">def</span> <span class="nf">__kullback_leibler</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 36.3 us</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The actual KL implementation. @see kullback_leibler() for details.</span>
<span class="sd">    Expects the histograms to be of type scipy.ndarray.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">h1</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">h1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="n">h2</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
       
<div class="viewcode-block" id="jensen_shannon"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.jensen_shannon.html#medpy.metric.histogram.jensen_shannon">[docs]</a><span class="k">def</span> <span class="nf">jensen_shannon</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 85 us @array, 110 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Jensen-Shannon divergence.</span>
<span class="sd">    </span>
<span class="sd">    A symmetric and numerically more stable empirical extension of the Kullback-Leibler</span>
<span class="sd">    divergence.</span>
<span class="sd">    </span>
<span class="sd">    The Jensen Shannon divergence between two histograms :math:`H` and :math:`H&#39;` of size</span>
<span class="sd">    :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{JSD}(H, H&#39;) =</span>
<span class="sd">            \frac{1}{2} d_{KL}(H, H^*) +</span>
<span class="sd">            \frac{1}{2} d_{KL}(H&#39;, H^*)</span>
<span class="sd">    </span>
<span class="sd">    with :math:`H^*=\frac{1}{2}(H + H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, \infty)`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    jensen_shannon : float</span>
<span class="sd">        Jensen-Shannon divergence.    </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="k">return</span> <span class="n">__kullback_leibler</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">__kullback_leibler</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span></div>
    
<div class="viewcode-block" id="fidelity_based"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.fidelity_based.html#medpy.metric.histogram.fidelity_based">[docs]</a><span class="k">def</span> <span class="nf">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 25 us @array, 51 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    Also Bhattacharyya distance; see also the extensions `noelle_1` to `noelle_5`.</span>
<span class="sd">    </span>
<span class="sd">    The metric between two histograms :math:`H` and :math:`H&#39;` of size :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{F}(H, H&#39;) = \sum_{m=1}^M\sqrt{H_m * H&#39;_m}</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - not a metric, a similarity</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The fidelity between two histograms :math:`H` and :math:`H&#39;` is the same as the</span>
<span class="sd">    cosine between their square roots :math:`\sqrt{H}` and :math:`\sqrt{H&#39;}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">h2</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="n">result</span> <span class="k">else</span> <span class="n">result</span> <span class="c1"># for rounding errors</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">result</span> <span class="k">else</span> <span class="n">result</span> <span class="c1"># for rounding errors</span>
    <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="noelle_1"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.noelle_1.html#medpy.metric.histogram.noelle_1">[docs]</a><span class="k">def</span> <span class="nf">noelle_1</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 26 us @array, 52 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension of `fidelity_based` proposed by [1]_.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\bar{F}}(H, H&#39;) = 1 - d_{F}(H, H&#39;)</span>
<span class="sd">    </span>
<span class="sd">    See `fidelity_based` for the definition of :math:`d_{F}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M. Noelle &quot;Distribution Distance Measures Applied to 3-D Object Recognition&quot;, 2003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span></div>

<div class="viewcode-block" id="noelle_2"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.noelle_2.html#medpy.metric.histogram.noelle_2">[docs]</a><span class="k">def</span> <span class="nf">noelle_2</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 26 us @array, 52 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension of `fidelity_based` proposed by [1]_.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        </span>
<span class="sd">        d_{\sqrt{1-F}}(H, H&#39;) = \sqrt{1 - d_{F}(H, H&#39;)}</span>
<span class="sd">    </span>
<span class="sd">    See `fidelity_based` for the definition of :math:`d_{F}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M. Noelle &quot;Distribution Distance Measures Applied to 3-D Object Recognition&quot;, 2003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="noelle_3"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.noelle_3.html#medpy.metric.histogram.noelle_3">[docs]</a><span class="k">def</span> <span class="nf">noelle_3</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 26 us @array, 52 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension of `fidelity_based` proposed by [1]_.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\log(2-F)}(H, H&#39;) = \log(2 - d_{F}(H, H&#39;))</span>
<span class="sd">    </span>
<span class="sd">    See `fidelity_based` for the definition of :math:`d_{F}(H, H&#39;)`.</span>
<span class="sd">        </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, log(2)]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M. Noelle &quot;Distribution Distance Measures Applied to 3-D Object Recognition&quot;, 2003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="noelle_4"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.noelle_4.html#medpy.metric.histogram.noelle_4">[docs]</a><span class="k">def</span> <span class="nf">noelle_4</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 26 us @array, 52 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension of `fidelity_based` proposed by [1]_.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\arccos F}(H, H&#39;) = \frac{2}{\pi} \arccos d_{F}(H, H&#39;)</span>
<span class="sd">    </span>
<span class="sd">    See `fidelity_based` for the definition of :math:`d_{F}(H, H&#39;)`.</span>
<span class="sd">            </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M. Noelle &quot;Distribution Distance Measures Applied to 3-D Object Recognition&quot;, 2003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">2.</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span></div>

<div class="viewcode-block" id="noelle_5"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.noelle_5.html#medpy.metric.histogram.noelle_5">[docs]</a><span class="k">def</span> <span class="nf">noelle_5</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 26 us @array, 52 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extension of `fidelity_based` proposed by [1]_.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\sin F}(H, H&#39;) = \sqrt{1 -d_{F}^2(H, H&#39;)}</span>
<span class="sd">    </span>
<span class="sd">    See `fidelity_based` for the definition of :math:`d_{F}(H, H&#39;)`.</span>
<span class="sd">                </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fidelity_based : float</span>
<span class="sd">        Fidelity based distance.</span>
<span class="sd">    </span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] M. Noelle &quot;Distribution Distance Measures Applied to 3-D Object Recognition&quot;, 2003</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">fidelity_based</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="cosine_alt"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.cosine_alt.html#medpy.metric.histogram.cosine_alt">[docs]</a><span class="k">def</span> <span class="nf">cosine_alt</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 17 us @array, 42 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alternative implementation of the `cosine` distance measure.</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Under development.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">h2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span></div>

<div class="viewcode-block" id="cosine"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.cosine.html#medpy.metric.histogram.cosine">[docs]</a><span class="k">def</span> <span class="nf">cosine</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 17 us @array, 42 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cosine simmilarity.</span>
<span class="sd">    </span>
<span class="sd">    Compute the angle between the two histograms in vector space irrespective of their</span>
<span class="sd">    length. The cosine similarity between two histograms :math:`H` and :math:`H&#39;` of size</span>
<span class="sd">    :math:`m` is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\cos}(H, H&#39;) = \cos\alpha = \frac{H * H&#39;}{\|H\| \|H&#39;\|} = \frac{\sum_{m=1}^M H_m*H&#39;_m}{\sqrt{\sum_{m=1}^M H_m^2} * \sqrt{\sum_{m=1}^M {H&#39;}_m^2}}</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - not a metric, a similarity</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[-1, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable    </span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cosine : float</span>
<span class="sd">        Cosine simmilarity.</span>
<span class="sd">        </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The resulting similarity ranges from -1 meaning exactly opposite, to 1 meaning</span>
<span class="sd">    exactly the same, with 0 usually indicating independence, and in-between values</span>
<span class="sd">    indicating intermediate similarity or dissimilarity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">h2</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1</span><span class="p">))</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h2</span><span class="p">)))</span></div>

<div class="viewcode-block" id="cosine_1"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.cosine_1.html#medpy.metric.histogram.cosine_1">[docs]</a><span class="k">def</span> <span class="nf">cosine_1</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 18 us @array, 43 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cosine simmilarity.</span>
<span class="sd">    </span>
<span class="sd">    Turns the cosine similarity into a distance measure for normalized, positive</span>
<span class="sd">    histograms.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\bar{\cos}}(H, H&#39;) = 1 - d_{\cos}(H, H&#39;)</span>
<span class="sd">    </span>
<span class="sd">    See `cosine` for the definition of :math:`d_{\cos}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cosine : float</span>
<span class="sd">        Cosine distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">cosine</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span></div>

<div class="viewcode-block" id="cosine_2"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.cosine_2.html#medpy.metric.histogram.cosine_2">[docs]</a><span class="k">def</span> <span class="nf">cosine_2</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 19 us @array, 44 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cosine simmilarity.</span>
<span class="sd">    </span>
<span class="sd">    Turns the cosine similarity into a distance measure for normalized, positive</span>
<span class="sd">    histograms.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\bar{\cos}}(H, H&#39;) = 1 - \frac{2*\arccos d_{\cos}(H, H&#39;)}{pi}</span>
<span class="sd">    </span>
<span class="sd">    See `cosine` for the definition of :math:`d_{\cos}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - metric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram, normalized.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, normalized, same bins as ``h1``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cosine : float</span>
<span class="sd">        Cosine distance. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cosine</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span></div>

<div class="viewcode-block" id="correlate"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.correlate.html#medpy.metric.histogram.correlate">[docs]</a><span class="k">def</span> <span class="nf">correlate</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 31 us @array, 55 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Correlation between two histograms.</span>
<span class="sd">    </span>
<span class="sd">    The histogram correlation between two histograms :math:`H` and :math:`H&#39;` of size :math:`m`</span>
<span class="sd">    is defined as:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{corr}(H, H&#39;) = </span>
<span class="sd">        \frac{</span>
<span class="sd">            \sum_{m=1}^M (H_m-\bar{H}) \cdot (H&#39;_m-\bar{H&#39;})</span>
<span class="sd">        }{</span>
<span class="sd">            \sqrt{\sum_{m=1}^M (H_m-\bar{H})^2 \cdot \sum_{m=1}^M (H&#39;_m-\bar{H&#39;})^2}</span>
<span class="sd">        }</span>
<span class="sd">    </span>
<span class="sd">    with :math:`\bar{H}` and :math:`\bar{H&#39;}` being the mean values of :math:`H` resp. :math:`H&#39;`</span>
<span class="sd">        </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - not a metric, a similarity</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[-1, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[-1, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 1`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correlate : float</span>
<span class="sd">        Correlation between the histograms.</span>
<span class="sd">        </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Returns 0 if one of h1 or h2 contain only zeros.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">h1m</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">h2m</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">h2</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">h1m</span><span class="p">,</span> <span class="n">h2m</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h1m</span><span class="p">))</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">h2m</span><span class="p">)))</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">b</span> <span class="k">else</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span></div>

<div class="viewcode-block" id="correlate_1"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.correlate_1.html#medpy.metric.histogram.correlate_1">[docs]</a><span class="k">def</span> <span class="nf">correlate_1</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span> <span class="c1"># 32 us @array, 56 us @list \w 100 bins</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Correlation distance.</span>
<span class="sd">    </span>
<span class="sd">    Turns the histogram correlation into a distance measure for normalized, positive</span>
<span class="sd">    histograms.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        d_{\bar{corr}}(H, H&#39;) = 1-\frac{d_{corr}(H, H&#39;)}{2}.</span>
<span class="sd">    </span>
<span class="sd">    See `correlate` for the definition of :math:`d_{corr}(H, H&#39;)`.</span>
<span class="sd">    </span>
<span class="sd">    *Attributes:*</span>

<span class="sd">    - semimetric</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-normalized histograms:*</span>

<span class="sd">    - :math:`d(H, H&#39;)\in[0, 1]`</span>
<span class="sd">    - :math:`d(H, H) = 0`</span>
<span class="sd">    - :math:`d(H, H&#39;) = d(H&#39;, H)`</span>
<span class="sd">    </span>
<span class="sd">    *Attributes for not-equal histograms:*</span>

<span class="sd">    - not applicable</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    h1 : sequence</span>
<span class="sd">        The first histogram.</span>
<span class="sd">    h2 : sequence</span>
<span class="sd">        The second histogram, same bins as ``h1``.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correlate : float</span>
<span class="sd">        Correlation distnace between the histograms.</span>
<span class="sd">        </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Returns 0.5 if one of h1 or h2 contains only zeros.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">correlate</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">))</span><span class="o">/</span><span class="mf">2.</span></div>


<span class="c1"># ///////////////////////////// #</span>
<span class="c1"># Cross-bin comparison measures #</span>
<span class="c1"># ///////////////////////////// #</span>

<div class="viewcode-block" id="quadratic_forms"><a class="viewcode-back" href="../../../generated/medpy.metric.histogram.quadratic_forms.html#medpy.metric.histogram.quadratic_forms">[docs]</a><span class="k">def</span> <span class="nf">quadratic_forms</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Quadrativ forms metric.</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    UNDER DEVELOPMENT</span>
<span class="sd">    </span>
<span class="sd">    This distance measure shows very strange behaviour. The expression</span>
<span class="sd">    transpose(h1-h2) * A * (h1-h2) yields egative values that can not be processed by the</span>
<span class="sd">    square root. Some examples::</span>
<span class="sd">    </span>
<span class="sd">        h1        h2                                          transpose(h1-h2) * A * (h1-h2)</span>
<span class="sd">        [1, 0] to [0.0, 1.0] :                                -2.0</span>
<span class="sd">        [1, 0] to [0.5, 0.5] :                                 0.0</span>
<span class="sd">        [1, 0] to [0.6666666666666667, 0.3333333333333333] :   0.111111111111</span>
<span class="sd">        [1, 0] to [0.75, 0.25] :                               0.0833333333333</span>
<span class="sd">        [1, 0] to [0.8, 0.2] :                                 0.06</span>
<span class="sd">        [1, 0] to [0.8333333333333334, 0.16666666666666666] :  0.0444444444444</span>
<span class="sd">        [1, 0] to [0.8571428571428572, 0.14285714285714285] :  0.0340136054422</span>
<span class="sd">        [1, 0] to [0.875, 0.125] :                             0.0267857142857</span>
<span class="sd">        [1, 0] to [0.8888888888888888, 0.1111111111111111] :   0.0216049382716</span>
<span class="sd">        [1, 0] to [0.9, 0.1] :                                 0.0177777777778</span>
<span class="sd">        [1, 0] to [1, 0]:                                      0.0</span>
<span class="sd">    </span>
<span class="sd">    It is clearly undesireable to recieve negative values and even worse to get a value</span>
<span class="sd">    of zero for other cases than the same histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">__quadratic_forms_matrix_euclidean</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h1</span><span class="o">-</span><span class="n">h2</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">h1</span><span class="o">-</span><span class="n">h2</span><span class="p">)))</span> <span class="c1"># transpose(h1-h2) * A * (h1-h2)</span></div>
    
<span class="k">def</span> <span class="nf">__quadratic_forms_matrix_euclidean</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the bin-similarity matrix for the quadratic form distance measure.</span>
<span class="sd">    The matric :math:`A` for two histograms :math:`H` and :math:`H&#39;` of size :math:`m` and</span>
<span class="sd">    :math:`n` respectively is defined as</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">        A_{m,n} = 1 - \frac{d_2(H_m, {H&#39;}_n)}{d_{max}}</span>
<span class="sd">    </span>
<span class="sd">    with</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">       d_{max} = \max_{m,n}d_2(H_m, {H&#39;}_n)</span>
<span class="sd">    </span>
<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    quadratic_forms</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">h2</span><span class="p">[:,</span><span class="n">scipy</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">h1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># repeat second array to form a matrix</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">h1</span><span class="p">)</span> <span class="c1"># euclidean distances</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">A</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>


<span class="c1"># //////////////// #</span>
<span class="c1"># Helper functions #</span>
<span class="c1"># //////////////// #</span>

<span class="k">def</span> <span class="nf">__prepare_histogram</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert the histograms to scipy.ndarrays if required.&quot;&quot;&quot;</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">h1</span> <span class="k">if</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span> <span class="k">else</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="n">h2</span> <span class="k">if</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span> <span class="k">else</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">h1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">h2</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="n">h1</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">h2</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;h1 and h2 must be of same shape and size&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span>
</pre></div>

          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2018, Oskar Maier.
      </li>
      <li>
      Last updated on Nov 23, 2018.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.7.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>
